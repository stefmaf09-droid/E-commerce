"""
I18n Utility - Fonctions pour l'internationalisation (multi-devises et traductions).
"""

import streamlit as st
from streamlit.components.v1 import html

# Dictionnaire de symboles mon√©taires
CURRENCY_SYMBOLS = {
    'EUR': '‚Ç¨',
    'USD': '$',
    'GBP': '¬£',
    'CAD': 'C$',
    'AUD': 'A$',
    'JPY': '¬•'
}

def get_browser_language():
    """
    D√©tecte la langue du navigateur de l'utilisateur.
    
    Returns:
        str: Code langue en majuscules ('FR', 'EN', 'DE', 'IT', 'ES')
    """
    # Try to get from session state first
    if 'browser_language' in st.session_state:
        return st.session_state.browser_language
    
    # Use JavaScript to get browser language
    language_js = """
    <script>
        const lang = navigator.language || navigator.userLanguage;
        const langCode = lang.substring(0, 2).toUpperCase();
        window.parent.postMessage({type: 'streamlit:setComponentValue', value: langCode}, '*');
    </script>
    """
    
    try:
        # Default to French if unable to detect
        detected_lang = 'FR'
        
        # Try to get from browser headers through Streamlit
        # Streamlit doesn't expose headers directly, so we'll use a simpler approach
        # Check query params if language is manually set
        query_params = st.query_params
        if 'lang' in query_params:
            detected_lang = query_params['lang'].upper()
        
        # Store in session state
        st.session_state.browser_language = detected_lang
        return detected_lang
    except:
        return 'FR'


def format_currency(amount: float, currency_code: str = 'EUR') -> str:
    """
    Formate un montant avec le symbole mon√©taire appropri√©.
    
    Args:
        amount: Montant √† formater
        currency_code: Code ISO de la devise (EUR, USD, etc.)
        
    Returns:
        Cha√Æne format√©e (ex: '124,50 ‚Ç¨' ou '$124.50')
    """
    symbol = CURRENCY_SYMBOLS.get(currency_code.upper(), '‚Ç¨')
    
    if currency_code.upper() in ['USD', 'GBP', 'CAD', 'AUD']:
        return f"{symbol}{amount:,.2f}"
    else:
        # Format europ√©en: 1.234,56 ‚Ç¨
        # On utilise une astuce pour ne pas toucher √† l'espace final
        num_part = f"{amount:,.2f}".replace(',', 'X').replace('.', ',').replace('X', '.')
        return f"{num_part} {symbol}"

def get_i18n_text(key: str, lang: str = None) -> str:
    """
    R√©cup√®re une traduction pour une cl√© donn√©e.
    
    Args:
        key: Cl√© de traduction
        lang: Langue ('FR', 'EN', etc.). Si None, d√©tecte automatiquement
        
    Returns:
        Texte traduit
    """
    # Auto-detect language if not provided
    if lang is None:
        lang = get_browser_language()
    
    translations = {
        'FR': {
            # Dashboard
            'dashboard_title': 'Refundly.ai - Tableau de bord',
            'recoverable': 'üí∞ R√âCUP√âRABLE',
            'your_share': 'üéØ VOTRE PART',
            'recovered': '‚úÖ R√âCUP√âR√â',
            'disputes_count': 'üì¶ LITIGES √âLIGIBLES',
            
            # Buttons & Actions
            'btn_back': 'Retour',
            'btn_view': 'Voir',
            'btn_escalate': 'Escalader',
            'btn_archive': 'Archiver',
            'btn_download_pdf': 'T√©l√©charger PDF',
            'btn_add_note': 'Ajouter une note',
            'btn_view_details': 'Voir les d√©tails',
            'btn_save_note': 'Enregistrer la note',
            
            # Page Titles & Headers
            'dispute_details': 'LITIGE',
            'carrier_overview': 'Vue d\'ensemble',
            'order_information': 'Informations de commande',
            'timeline': 'Chronologie',
            'evidence_photos': 'Photos de preuve',
            'statistics': 'Statistiques',
            'all_disputes': 'Tous les litiges',
            
            # Labels
            'status': 'Statut',
            'financial': 'Finances',
            'actions': 'Actions',
            'customer': 'Client',
            'email': 'Email',
            'address': 'Adresse',
            'order_date': 'Date de commande',
            'issue_type': 'Type de probl√®me',
            'tracking': 'Suivi',
            'order': 'Commande',
            
            # Financial
            'total_recoverable': 'Total r√©cup√©rable',
            'you_receive': 'Vous recevez',
            'our_fee': 'Nos frais',
            'ai_confidence': 'Confiance IA',
            
            # Statistics
            'active_disputes': 'Litiges actifs',
            'win_rate': 'Taux de succ√®s',
            'total_recoverable': 'Total r√©cup√©rable',
            
            # Dispute Types
            'delayed_delivery': 'Livraison retard√©e',
            'lost_package': 'Colis perdu',
            'damaged_package': 'Colis endommag√©',
            'invalid_pod': 'POD invalide',
            'unknown': 'Probl√®me inconnu',
            
            # Messages
            'no_evidence_yet': 'Aucune photo de preuve t√©l√©charg√©e',
            'no_disputes_found': 'Aucun litige trouv√© avec',
            'all_disputes_with': 'Tous les litiges',
            'your_note': 'Votre note',
            
            # Status labels
            'status_pending': '‚è≥ En attente',
            'status_processing': 'üîÑ En traitement',
            'status_under_review': 'üìã En r√©vision',
            'status_resolved': '‚úÖ R√©solu',
            'status_rejected': '‚ùå Rejet√©',
            
            # POD (Proof of Delivery) - UI
            'pod_status_title': 'Statut POD (Proof of Delivery)',
            'pod_status_caption': 'Visualisez la disponibilit√© des preuves de livraison et relancez les √©checs',
            'pod_available': 'POD Disponibles',
            'pod_pending': 'En attente',
            'pod_failed': '√âchecs',
            'pod_not_requested': 'Non demand√©s',
            'pod_available_for': 'POD disponible',
            'pod_failed_for': '√âchec POD',
            'pod_fetching': 'POD en cours de r√©cup√©ration',
            'pod_url_unavailable': 'URL non disponible',
            'pod_error': 'Erreur',
            'btn_retry': 'R√©essayer',
            'btn_retry_all': 'R√©essayer tous les √©checs',
            'btn_download_pod': 'T√©l√©charger',
            'pod_bulk_retry_complete': 'R√©essai en masse termin√© !',
            'pod_bulk_success': 'Succ√®s',
            'pod_bulk_failed': '√âchecs',
            'pod_bulk_skipped': 'Ignor√©s (rate limit)',
            'pod_bulk_processing': 'Traitement',
            
            # POD Email Notifications
            'email_pod_retrieved_subject': 'Preuve de livraison disponible',
            'email_pod_retrieved_title': 'POD r√©cup√©r√© avec succ√®s',
            'email_pod_retrieved_message': 'La preuve de livraison pour votre r√©clamation {claim_ref} est maintenant disponible.',
            'email_pod_failed_subject': 'POD non disponible - Action requise',
            'email_pod_failed_title': 'R√©cup√©ration POD impossible',
            'email_pod_failed_message': 'Nous n\'avons pas pu r√©cup√©rer la preuve de livraison pour votre r√©clamation {claim_ref}.',
            'email_pod_reason': 'Raison',
            'email_pod_action_required': 'Veuillez v√©rifier le num√©ro de suivi aupr√®s du transporteur.',
            'email_greeting': 'Bonjour',
            'email_signature_team': 'L\'√©quipe Refundly',
            'email_view_claim': 'Consulter la r√©clamation',
            'email_manage_preferences': 'Vous pouvez g√©rer vos pr√©f√©rences de notifications',
            'email_here': 'ici',
            
            # Claims Management Page
            'claims_management_title': 'Gestion des Litiges',
            'claims_management_caption': 'Visualisez et g√©rez vos r√©clamations en masse',
            'total_claims': 'Total litiges',
            'claims_accepted': 'Accept√©s',
            'claims_pending': 'En cours',
            'claims_rejected': 'Rejet√©s',
            'bulk_actions_title': 'Actions group√©es',
            'claims_list_title': 'Liste des litiges',
            'btn_export_csv': 'Exporter tout en CSV',
            'btn_send_reminders': 'Envoyer rappels (en cours)',
            'btn_delete_selection': 'Supprimer s√©lection',
            'btn_confirm_delete': 'Confirmer la suppression',
            'btn_cancel': 'Annuler',
            'delete_warning': 'Attention : La suppression est d√©finitive !',
            'claims_deleted': 'Litiges supprim√©s',
            'client_not_found': 'Client non trouv√©',
            'error_loading_claims': 'Erreur lors du chargement des litiges',
            'csv_ready': 'litiges pr√™ts √† √™tre export√©s !',
            'error_export': 'Erreur lors de l\'export',
            'no_tracking': 'Impossible de r√©essayer: num√©ro de suivi manquant',
            'rate_limit_reached': 'Limite d\'API atteinte pour {carrier}. R√©essayez apr√®s {time}',
            'retrieving_pod': 'R√©cup√©ration POD pour {tracking}...',
            'pod_status_available': 'POD disponible - {claim_ref}',
            'pod_status_failed': '√âchec POD - {claim_ref}',
            'pod_status_fetching': 'POD en cours de r√©cup√©ration - {claim_ref}',
            'pod_retrieved_success': 'POD r√©cup√©r√© avec succ√®s!',
            'pod_retrieved_notification_failed': 'POD r√©cup√©r√© mais notification √©chou√©e: {error}',
            'pod_failed_error': '√âchec: {error}',
            'notification_failed': 'Notification √©chou√©e: {error}',
            'notification_sent_persistent': 'Email envoy√© (erreur persistante)',
            'notification_temp_error': 'Erreur temporaire - pas d\'email envoy√©',
            'no_failed_pods': 'Aucun POD en √©chec √† r√©essayer',
            'bulk_retry_processing': 'Traitement {current}/{total}: {claim_ref}',
            'bulk_retry_summary': 'R√©essai en masse termin√© !',
            'bulk_retry_success_count': 'Succ√®s',
            'bulk_retry_failed_count': '√âchecs',
            'bulk_retry_skipped_count': 'Ignor√©s (rate limit)',
            'download_csv': 'T√©l√©charger le CSV',
            'error_pod_retrieval': 'Erreur lors de la r√©cup√©ration POD: {error}',
            'pod_not_available': 'POD non disponible',
            'pod_file_not_found': 'Fichier POD introuvable',
            'pod_gallery': 'Galerie POD',
            'select_pod': 'S√©lectionner un POD',
            'no_pods_available': 'Aucun POD disponible',
            'previous': 'Pr√©c√©dent',
            'next': 'Suivant',
            'view_pod': 'Voir POD',
            'btn_retry_pod': 'R√©essayer',
            'pod_analytics_title': 'Analytiques POD',
            'pod_analytics_subtitle': 'Performance de r√©cup√©ration des preuves de livraison',
            'time_range': 'P√©riode',
            'last_7_days': '7 derniers jours',
            'last_30_days': '30 derniers jours',
            'last_90_days': '90 derniers jours',
            'all_time': 'Depuis le d√©but',
            'no_pod_data': 'Aucune donn√©e POD disponible',
            'overview_metrics': 'Vue d\'ensemble',
            'total_pods': 'Total PODs',
            'avg_fetch_time': 'Temps moyen',
            'carrier_performance': 'Performance par transporteur',
            'no_carrier_data': 'Aucune donn√©e transporteur',
            'retry_analysis': 'Analyse des r√©essais',
            'no_retry_data': 'Aucune donn√©e de r√©essai',
            'retry_summary': 'R√©sum√©',
            'error_breakdown': 'Classification des erreurs',
            'no_errors': 'Aucune erreur enregistr√©e',
            'occurrences': 'occurrences',
            'time_trends': 'Tendances temporelles',
            'no_trend_data': 'Aucune donn√©e de tendance',
            'avg_daily_pods': 'Moyenne quotidienne',
            'success': 'Succ√®s',
            'avg': 'Moy',
            
            # Settings Page
            'settings_header': 'R√©glages',
            'store_management': 'Gestion des Magasins',
            'store_management_caption': 'Ajoutez, synchronisez ou supprimez vos boutiques e-commerce',
            'connected_stores': 'Vos boutiques connect√©es',
            'sync': 'Synchroniser',
            'delete': 'Supprimer',
            'store_deleted': 'Boutique supprim√©e',
            'confirm_delete': 'Cliquez √† nouveau pour confirmer',
            'no_stores': 'Aucune boutique connect√©e pour le moment',
            'add_store': 'Ajouter une nouvelle boutique',
            'connect_store': 'Connectez une nouvelle boutique',
            'platform': 'Plateforme e-commerce',
            'store_name': 'Nom de la boutique',
            'url': 'URL',
            'shop_url': 'Shop URL',
            'access_token': 'Access Token',
            'consumer_key': 'Consumer Key',
            'consumer_secret': 'Consumer Secret',
            'api_key': 'API Key',
            'api_secret': 'API Secret',
            'add_this_store': 'Ajouter cette boutique',
            'all_fields_required': 'Tous les champs sont obligatoires',
            'store_added_success': 'Boutique {store_name} ajout√©e avec succ√®s !',
            'error_adding_store': 'Erreur lors de l\'ajout de la boutique',
            'platform_info': 'Informations Plateforme',
            'platform_info_caption': 'D√©tails de connexion √† votre plateforme e-commerce',
            'store_url_label': 'URL de la boutique',
            'connection_status': 'Statut de connexion',
            'connected': 'Connect√©',
            'api_credentials': 'Identifiants API',
            'no_api_key': 'Aucune cl√© API enregistr√©e',
            'credentials_encrypted': 'Les identifiants complets sont chiffr√©s et stock√©s en s√©curit√©',
            'no_store_selected': 'Aucune boutique s√©lectionn√©e. Veuillez d\'abord connecter une boutique.',
            'bank_info': 'Informations Bancaires',
            'bank_info_caption': 'Vos coordonn√©es pour recevoir les remboursements (80% des montants r√©cup√©r√©s)',
            'iban': 'IBAN',
            'bic': 'BIC/SWIFT',
            'account_holder': 'Titulaire du compte',
            'bank_name': 'Nom de la banque',
            'bank_info_saved': 'Informations bancaires enregistr√©es',
            'edit_bank_info': 'Modifier mes coordonn√©es bancaires',
            'no_bank_info': 'Vous n\'avez pas encore renseign√© vos coordonn√©es bancaires',
            'why_important': 'Pourquoi c\'est important ?',
            'bank_info_reason': 'Pour recevoir vos remboursements automatiquement, nous avons besoin de votre IBAN.',
            'add_bank_info': 'Ajouter mes coordonn√©es bancaires',
            'save': 'Enregistrer',
            'iban_holder_required': 'L\'IBAN et le titulaire sont obligatoires',
            'bank_info_saved_success': 'Coordonn√©es bancaires enregistr√©es avec succ√®s !',
            'notification_prefs': 'Pr√©f√©rences de Notifications Email',
            'notification_prefs_caption': 'Contr√¥lez les emails que vous recevez pour ne jamais √™tre submerg√©',
            'notification_types': 'Types de notifications',
            'notification_types_caption': 'D√©cochez les notifications que vous ne souhaitez pas recevoir',
            'notif_claim_created': 'Nouveau litige cr√©√©',
            'notif_claim_updated': 'Mise √† jour du litige',
            'notif_claim_accepted': 'Litige accept√©',
            'notif_payment_received': 'Paiement re√ßu',
            'notif_deadline_warning': 'Deadline proche (J-3)',
            'frequency': 'Fr√©quence d\'envoi',
            'frequency_caption': 'Choisissez comment recevoir vos notifications',
            'freq_immediate': 'Imm√©diat (d√®s que l\'√©v√©nement se produit)',
            'freq_daily': 'Quotidien (r√©sum√© une fois par jour √† 9h)',
            'freq_weekly': 'Hebdomadaire (r√©sum√© le lundi matin)',
            'frequency_tip': 'Astuce : Si vous recevez beaucoup de litiges, le mode \'Quotidien\' vous √©vitera d\'√™tre submerg√© d\'emails.',
            'save_preferences': 'Enregistrer mes pr√©f√©rences',
            'preferences_saved': 'Pr√©f√©rences enregistr√©es avec succ√®s !',
            'email_templates': 'Templates d\'Emails',
            'email_templates_caption': 'Personnalisez le contenu des emails d\'escalade automatiques',
            'templates_info': 'Vous pouvez personnaliser les emails envoy√©s automatiquement lors des escalades (demande de statut, avertissement, mise en demeure).',
            'custom_templates': '{count} template(s) personnalis√©(s)',
            'default_templates': 'Templates par d√©faut',
            'edit_templates': 'Modifier les templates',
            
            # Reports Page
            'reports_header': 'Reports & Analytics',
            'timeline_recent_events': 'Timeline des √âv√©nements R√©cents',
            'timeline_caption': 'Historique chronologique de vos litiges et actions',
            'new_dispute': 'Nouveau litige d√©tect√©',
            'claim_submitted': 'R√©clamation soumise',
            'refund_received': 'Remboursement re√ßu',
            'legal_escalation': 'Escalade juridique',
            'sync_successful': 'Synchronisation r√©ussie',
            'orders_analyzed': '{count} commandes analys√©es',
            
            # Legal (existing)
            'legal_header_from': 'EXP√âDITEUR :',
            'legal_header_to': 'DESTINATAIRE :',
            'legal_header_subject': 'OBJET : MISE EN DEMEURE POUR D√âFAUT D\'INDEMNISATION',
            'legal_ref_claim': 'R√©f. R√©clamation :',
            'legal_ref_tracking': 'R√©f. Colis (Tracking) :',
            'legal_body_intro': 'Nous faisons suite √† notre r√©clamation concernant le litige cit√© en r√©f√©rence.',
            'legal_body_law': 'En vertu de l\'article L133-1 du Code des Transports, vous √™tes garant de la perte ou de l\'avarie des objets √† transporter.',
            'legal_body_demand': 'Par la pr√©sente, nous vous METTONS EN DEMEURE d\'effectuer le r√®glement sous 8 jours.',
            'legal_body_closing': '√Ä d√©faut, nous saisirons le M√©diateur comp√©tent.',
            'legal_signature': 'POUR ORDRE : L\'AGENT MANDATAIRE AUTOMATIS√â',
            
            # Lois Internationales (Fallback sur le texte Anglais ou traduit si pertinent)
            'legal_law_ny': 'En vertu de la loi g√©n√©rale des affaires de l\'√âtat de New York (¬ß 396-u) et de l\'Amendement Carmack f√©d√©ral (49 U.S.C. ¬ß 14706), le transporteur est responsable en tant qu\'assureur de la perte ou des dommages.',
            'legal_law_ca': 'En vertu du Code de commerce de Californie ¬ß 7309, un transporteur qui √©met un connaissement est tenu d\'exercer le degr√© de soin qu\'une personne raisonnablement prudente exercerait.',
            'legal_law_tx': 'En vertu de la loi texane sur les pratiques commerciales trompeuses (DTPA) et de la responsabilit√© de common law des transporteurs, vous √™tes responsable de la livraison s√©curis√©e des marchandises.',
            'legal_law_us_federal': 'En vertu de l\'Amendement Carmack f√©d√©ral (49 U.S.C. ¬ß 14706), un transporteur public est responsable de la "perte ou du pr√©judice r√©el √† la propri√©t√©" survenant pendant le transport.',
            'legal_law_fl': 'En vertu de la loi de Floride sur les pratiques commerciales d√©loyales (FDUTPA) et des statuts de Floride ¬ß 677.309, le transporteur est responsable des dommages.',
            'legal_law_il': 'En vertu de la loi de l\'Illinois sur la fraude √† la consommation et des statuts compil√©s (810 ILCS 5/7-309), le transporteur doit exercer un degr√© de soin raisonnable.',
            'legal_law_uk': 'En vertu de la Loi sur les droits des consommateurs de 2015 (UK) et de la Loi sur le transport de marchandises par route de 1965, le transporteur est strictement responsable de la perte ou des dommages.',
            'legal_law_eu_cmr': 'Conform√©ment √† la Convention CMR (Article 17) et aux r√©glementations de transport de l\'UE, le transporteur est responsable de la perte totale ou partielle des marchandises.'
        },
        'EN': {
            # Dashboard
            'dashboard_title': 'Client Dashboard',
            'recoverable': 'üí∞ RECOVERABLE',
            'your_share': 'üéØ YOUR SHARE',
            'recovered': '‚úÖ RECOVERED',
            'disputes_count': 'üì¶ ELIGIBLE DISPUTES',
            
            # Buttons & Actions
            'btn_back': 'Back',
            'btn_view': 'View',
            'btn_escalate': 'Escalate',
            'btn_archive': 'Archive',
            'btn_download_pdf': 'Download PDF',
            'btn_add_note': 'Add Note',
            'btn_view_details': 'View Details',
            'btn_save_note': 'Save Note',
            
            # Page Titles & Headers
            'dispute_details': 'DISPUTE',
            'carrier_overview': 'Overview',
            'order_information': 'Order Information',
            'timeline': 'Timeline',
            'evidence_photos': 'Evidence Photos',
            'statistics': 'Statistics',
            'all_disputes': 'All Disputes',
            
            # Labels
            'status': 'Status',
            'financial': 'Financial',
            'actions': 'Actions',
            'customer': 'Customer',
            'email': 'Email',
            'address': 'Address',
            'order_date': 'Order Date',
            'issue_type': 'Issue Type',
            'tracking': 'Tracking',
            'order': 'Order',
            
            # Financial
            'total_recoverable': 'Total Recoverable',
            'you_receive': 'You Receive',
            'our_fee': 'Our Fee',
            'ai_confidence': 'AI Confidence',
            
            # Statistics
            'active_disputes': 'Active Disputes',
            'win_rate': 'Win Rate',
            
            # Dispute Types
            'delayed_delivery': 'Delayed delivery',
            'lost_package': 'Lost package',
            'damaged_package': 'Damaged package',
            'invalid_pod': 'Invalid POD',
            'unknown': 'Unknown issue',
            
            # Messages
            'no_evidence_yet': 'No evidence photos uploaded yet',
            'no_disputes_found': 'No disputes found with',
            'all_disputes_with': 'All disputes with',
            'your_note': 'Your note',
            
            # Status labels
            'status_pending': '‚è≥ Pending',
            'status_processing': 'üîÑ Processing',
            'status_under_review': 'üìã Under Review',
            'status_resolved': '‚úÖ Resolved',
            'status_rejected': '‚ùå Rejected',
            
            # POD (Proof of Delivery) - UI
            'pod_status_title': 'POD Status (Proof of Delivery)',
            'pod_status_caption': 'View delivery proof availability and retry failures',
            'pod_available': 'Available PODs',
            'pod_pending': 'Pending',
            'pod_failed': 'Failed',
            'pod_not_requested': 'Not requested',
            'pod_available_for': 'POD available',
            'pod_failed_for': 'POD failed',
            'pod_fetching': 'POD being retrieved',
            'pod_url_unavailable': 'URL unavailable',
            'pod_error': 'Error',
            'btn_retry': 'Retry',
            'btn_retry_all': 'Retry all failed',
            'btn_download_pod': 'Download',
            'pod_bulk_retry_complete': 'Bulk retry complete!',
            'pod_bulk_success': 'Success',
            'pod_bulk_failed': 'Failed',
            'pod_bulk_skipped': 'Skipped (rate limit)',
            'pod_bulk_processing': 'Processing',
            
            # POD Email Notifications
            'email_pod_retrieved_subject': 'Proof of delivery available',
            'email_pod_retrieved_title': 'POD successfully retrieved',
            'email_pod_retrieved_message': 'The proof of delivery for your claim {claim_ref} is now available.',
            'email_pod_failed_subject': 'POD unavailable - Action required',
            'email_pod_failed_title': 'POD retrieval failed',
            'email_pod_failed_message': 'We could not retrieve the proof of delivery for your claim {claim_ref}.',
            'email_pod_reason': 'Reason',
            'email_pod_action_required': 'Please verify the tracking number with the carrier.',
            'email_greeting': 'Hello',
            'email_signature_team': 'The Refundly Team',
            'email_view_claim': 'View claim',
            'email_manage_preferences': 'You can manage your notification preferences',
            'email_here': 'here',
            
            # Claims Management Page
            'claims_management_title': 'Claims Management',
            'claims_management_caption': 'View and manage your claims in bulk',
            'total_claims': 'Total claims',
            'claims_accepted': 'Accepted',
            'claims_pending': 'Pending',
            'claims_rejected': 'Rejected',
            'bulk_actions_title': 'Bulk actions',
            'claims_list_title': 'Claims list',
            'btn_export_csv': 'Export all to CSV',
            'btn_send_reminders': 'Send reminders (in progress)',
            'btn_delete_selection': 'Delete selection',
            'btn_confirm_delete': 'Confirm deletion',
            'btn_cancel': 'Cancel',
            'delete_warning': 'Warning: Deletion is permanent!',
            'claims_deleted': 'Claims deleted',
            'client_not_found': 'Client not found',
            'error_loading_claims': 'Error loading claims',
            'csv_ready': 'claims ready to export!',
            'error_export': 'Error during export',
            'no_tracking': 'Cannot retry: tracking number missing',
            'rate_limit_reached': 'API limit reached for {carrier}. Retry after {time}',
            'retrieving_pod': 'Retrieving POD for {tracking}...',
            'pod_status_available': 'POD available - {claim_ref}',
            'pod_status_failed': 'POD failed - {claim_ref}',
            'pod_status_fetching': 'POD being retrieved - {claim_ref}',
            'pod_retrieved_success': 'POD successfully retrieved!',
            'pod_retrieved_notification_failed': 'POD retrieved but notification failed: {error}',
            'pod_failed_error': 'Failed: {error}',
            'notification_failed': 'Notification failed: {error}',
            'notification_sent_persistent': 'Email sent (persistent error)',
            'notification_temp_error': 'Temporary error - no email sent',
            'no_failed_pods': 'No failed PODs to retry',
            'bulk_retry_processing': 'Processing {current}/{total}: {claim_ref}',
            'bulk_retry_summary': 'Bulk retry complete!',
            'bulk_retry_success_count': 'Success',
            'bulk_retry_failed_count': 'Failed',
            'bulk_retry_skipped_count': 'Skipped (rate limit)',
            'download_csv': 'Download CSV',
            'error_pod_retrieval': 'Error retrieving POD: {error}',
            'pod_not_available': 'POD not available',
            'pod_file_not_found': 'POD file not found',
            'pod_gallery': 'POD Gallery',
            'select_pod': 'Select a POD',
            'no_pods_available': 'No PODs available',
            'previous': 'Previous',
            'next': 'Next',
            'view_pod': 'View POD',
            'btn_retry_pod': 'Retry',
            'pod_analytics_title': 'POD Analytics',
            'pod_analytics_subtitle': 'Proof of Delivery retrieval performance',
            'time_range': 'Time Range',
            'last_7_days': 'Last 7 days',
            'last_30_days': 'Last 30 days',
            'last_90_days': 'Last 90 days',
            'all_time': 'All time',
            'no_pod_data': 'No POD data available',
            'overview_metrics': 'Overview',
            'total_pods': 'Total PODs',
            'avg_fetch_time': 'Avg Time',
            'carrier_performance': 'Carrier Performance',
            'no_carrier_data': 'No carrier data',
            'retry_analysis': 'Retry Analysis',
            'no_retry_data': 'No retry data',
            'retry_summary': 'Summary',
            'error_breakdown': 'Error Classification',
            'no_errors': 'No errors recorded',
            'occurrences': 'occurrences',
            'time_trends': 'Time Trends',
            'no_trend_data': 'No trend data',
            'avg_daily_pods': 'Daily average',
            'success': 'Success',
            'avg': 'Avg',
            
            # Settings Page
            'settings_header': 'Settings',
            'store_management': 'Store Management',
            'store_management_caption': 'Add, sync or delete your e-commerce stores',
            'connected_stores': 'Your connected stores',
            'sync': 'Sync',
            'delete': 'Delete',
            'store_deleted': 'Store deleted',
            'confirm_delete': 'Click again to confirm',
            'no_stores': 'No connected stores yet',
            'add_store': 'Add a new store',
            'connect_store': 'Connect a new store',
            'platform': 'E-commerce platform',
            'store_name': 'Store name',
            'url': 'URL',
            'shop_url': 'Shop URL',
            'access_token': 'Access Token',
            'consumer_key': 'Consumer Key',
            'consumer_secret': 'Consumer Secret',
            'api_key': 'API Key',
            'api_secret': 'API Secret',
            'add_this_store': 'Add this store',
            'all_fields_required': 'All fields are required',
            'store_added_success': 'Store {store_name} added successfully!',
            'error_adding_store': 'Error adding store',
            'platform_info': 'Platform Information',
            'platform_info_caption': 'Connection details to your e-commerce platform',
            'store_url_label': 'Store URL',
            'connection_status': 'Connection status',
            'connected': 'Connected',
            'api_credentials': 'API Credentials',
            'no_api_key': 'No API key registered',
            'credentials_encrypted': 'Full credentials are encrypted and securely stored',
            'no_store_selected': 'No store selected. Please connect a store first.',
            'bank_info': 'Bank Information',
            'bank_info_caption': 'Your details to receive refunds (80% of recovered amounts)',
            'iban': 'IBAN',
            'bic': 'BIC/SWIFT',
            'account_holder': 'Account holder',
            'bank_name': 'Bank name',
            'bank_info_saved': 'Bank information saved',
            'edit_bank_info': 'Edit my bank details',
            'no_bank_info': 'You haven\'t provided your bank details yet',
            'why_important': 'Why is this important?',
            'bank_info_reason': 'To receive your refunds automatically, we need your IBAN.',
            'add_bank_info': 'Add my bank details',
            'save': 'Save',
            'iban_holder_required': 'IBAN and account holder are required',
            'bank_info_saved_success': 'Bank details saved successfully!',
            'notification_prefs': 'Email Notification Preferences',
            'notification_prefs_caption': 'Control the emails you receive to never be overwhelmed',
            'notification_types': 'Notification types',
            'notification_types_caption': 'Uncheck notifications you don\'t want to receive',
            'notif_claim_created': 'New claim created',
            'notif_claim_updated': 'Claim updated',
            'notif_claim_accepted': 'Claim accepted',
            'notif_payment_received': 'Payment received',
            'notif_deadline_warning': 'Deadline approaching (D-3)',
            'frequency': 'Send frequency',
            'frequency_caption': 'Choose how to receive your notifications',
            'freq_immediate': 'Immediate (as soon as the event occurs)',
            'freq_daily': 'Daily (summary once a day at 9am)',
            'freq_weekly': 'Weekly (summary on Monday morning)',
            'frequency_tip': 'Tip: If you receive many claims, \'Daily\' mode will prevent email overload.',
            'save_preferences': 'Save my preferences',
            'preferences_saved': 'Preferences saved successfully!',
            'email_templates': 'Email Templates',
            'email_templates_caption': 'Customize automatic escalation email content',
            'templates_info': 'You can customize emails sent automatically during escalationss (status request, warning, formal notice).',
            'custom_templates': '{count} custom template(s)',
            'default_templates': 'Default templates',
            'edit_templates': 'Edit templates',
            
            # Reports Page
            'reports_header': 'Reports & Analytics',
            'timeline_recent_events': 'Recent Events Timeline',
            'timeline_caption': 'Chronological history of your claims and actions',
            'new_dispute': 'New dispute detected',
            'claim_submitted': 'Claim submitted',
            'refund_received': 'Refund received',
            'legal_escalation': 'Legal escalation',
            'sync_successful': 'Sync successful',
            'orders_analyzed': '{count} orders analyzed',
            
            # Legal (existing)
            'legal_header_from': 'SENDER:',
            'legal_header_to': 'RECIPIENT:',
            'legal_header_subject': 'SUBJECT: FORMAL NOTICE FOR NON-PAYMENT OF COMPENSATION',
            'legal_ref_claim': 'Claim Ref:',
            'legal_ref_tracking': 'Tracking Ref:',
            'legal_body_intro': 'We are writing following our claim regarding the referenced dispute.',
            'legal_body_law': 'Under the applicable transport laws (including the Consumer Rights Act where applicable), you are liable for the loss or damage of goods in transit.',
            'legal_body_demand': 'We hereby give you FORMAL NOTICE to settle this claim within 8 days.',
            'legal_body_closing': 'Failing that, we will escalate this matter to the relevant Ombudsman.',
            'legal_signature': 'FOR AND ON BEHALF OF: THE AUTOMATED CLAIMS AGENT',
            'legal_law_ny': 'Under New York State General Business Law ¬ß 396-u and the Federal Carmack Amendment (49 U.S.C. ¬ß 14706), carrier is liable for loss or damage as an insurer.',
            'legal_law_ca': 'Under California Commercial Code ¬ß 7309, a carrier who issues a bill of lading is required to exercise the degree of care that a reasonably careful person would exercise.',
            'legal_law_tx': 'Under Texas Deceptive Trade Practices-Consumer Protection Act (DTPA) and Common Law carrier liability, you are responsible for the safe delivery of goods.',
            'legal_law_us_federal': 'Under the Federal Carmack Amendment (49 U.S.C. ¬ß 14706), a common carrier is liable for "actual loss or injury to the property" occurring during the transportation of goods in interstate commerce.',
            'legal_law_fl': 'Under the Florida Deceptive and Unfair Trade Practices Act (FDUTPA) and Florida Statutes ¬ß 677.309, a carrier is liable for damages for loss of or injury to the goods caused by its failure to exercise reasonable care.',
            'legal_law_il': 'Under the Illinois Consumer Fraud and Deceptive Business Practices Act and Illinois Compiled Statutes 810 ILCS 5/7-309, a carrier must exercise the degree of care that a reasonably careful person would exercise.',
            'legal_law_uk': 'Under the Consumer Rights Act 2015 and the Carriage of Goods by Road Act 1965, the carrier is strictly liable for the loss or damage of goods from the time they take possession until delivery.',
            'legal_body_law_uk': 'In accordance with the UK Consumer Rights Act 2015, the delivery of goods is a part of the contract, and you are responsible for ensuring they reach the consumer in satisfactory condition.',
            'legal_law_hk': 'Under the Control of Exemption Clauses Ordinance (Cap. 71) and common law principles governing contracts of carriage, the carrier is liable for loss or damage unless they can prove reasonable care was taken.',
            'legal_law_sg': 'Under the Carriage of Goods by Sea Act or the common law of bailment as applicable in Singapore, the carrier owes a duty of care to ensure the safe arrival of goods.',
            'legal_law_eu_cmr': 'Pursuant to the CMR Convention (Article 17) and relevant EU transport regulations, the carrier is liable for the total or partial loss of the goods and for damage thereto occurring between the time when they take over the goods and the time of delivery.',
            'legal_body_law_eu': 'According to the CMR Convention, which governs international and domestic transport in the EU, you are strictly liable for the safety and integrity of the shipment.'
        },
        'DE': {
            # Dashboard
            'dashboard_title': 'H√§ndler-Dashboard',
            'recoverable': 'üí∞ R√úCKFORDERBAR',
            'your_share': 'üéØ IHR ANTEIL',
            'recovered': '‚úÖ ERSTATTET',
            'disputes_count': 'üì¶ BERECHTIGTE F√ÑLLE',
            
            # Buttons & Actions
            'btn_back': 'Zur√ºck',
            'btn_view': 'Ansehen',
            'btn_escalate': 'Eskalieren',
            'btn_archive': 'Archivieren',
            'btn_download_pdf': 'PDF herunterladen',
            'btn_add_note': 'Notiz hinzuf√ºgen',
            'btn_view_details': 'Details ansehen',
            'btn_save_note': 'Notiz speichern',
            
            # Page Titles
            'dispute_details': 'STREITFALL',
            'carrier_overview': '√úbersicht',
            'order_information': 'Bestellinformationen',
            'timeline': 'Zeitleiste',
            'evidence_photos': 'Beweisfotos',
            'statistics': 'Statistiken',
            'all_disputes': 'Alle Streitf√§lle',
            
            # Labels
            'status': 'Status',
            'financial': 'Finanzen',
            'actions': 'Aktionen',
            'customer': 'Kunde',
            'email': 'E-Mail',
            'address': 'Adresse',
            'order_date': 'Bestelldatum',
            'issue_type': 'Problemtyp',
            'tracking': 'Sendungsnummer',
            'order': 'Bestellung',
            
            # Financial
            'total_recoverable': 'Gesamt r√ºckforderbar',
            'you_receive': 'Sie erhalten',
            'our_fee': 'Unsere Geb√ºhr',
            'ai_confidence': 'KI-Vertrauen',
            
            # Statistics
            'active_disputes': 'Aktive Streitf√§lle',
            'win_rate': 'Erfolgsquote',
            
            # Dispute Types
            'delayed_delivery': 'Versp√§tete Lieferung',
            'lost_package': 'Verlorenes Paket',
            'damaged_package': 'Besch√§digtes Paket',
            'invalid_pod': 'Ung√ºltige Zustellbest√§tigung',
            'unknown': 'Unbekanntes Problem',
            
            # Messages
            'no_evidence_yet': 'Noch keine Beweisfotos hochgeladen',
            'no_disputes_found': 'Keine Streitf√§lle gefunden mit',
            'all_disputes_with': 'Alle Streitf√§lle mit',
            'your_note': 'Ihre Notiz',
            
            # POD (Proof of Delivery) - UI
            'pod_status_title': 'POD-Status (Proof of Delivery)',
            'pod_status_caption': 'Zustellnachweise anzeigen und Fehler wiederholen',
            'pod_available': 'Verf√ºgbare PODs',
            'pod_pending': 'Ausstehend',
            'pod_failed': 'Fehlgeschlagen',
            'pod_not_requested': 'Nicht angefordert',
            'pod_available_for': 'POD verf√ºgbar',
            'pod_failed_for': 'POD fehlgeschlagen',
            'pod_fetching': 'POD wird abgerufen',
            'pod_url_unavailable': 'URL nicht verf√ºgbar',
            'pod_error': 'Fehler',
            'btn_retry': 'Wiederholen',
            'btn_retry_all': 'Alle Fehler wiederholen',
            'btn_download_pod': 'Herunterladen',
            'pod_bulk_retry_complete': 'Massenwiederholung abgeschlossen!',
            'pod_bulk_success': 'Erfolg',
            'pod_bulk_failed': 'Fehlgeschlagen',
            'pod_bulk_skipped': '√úbersprungen (Rate Limit)',
            'pod_bulk_processing': 'Verarbeitung',
            
            # POD Email Notifications
            'email_pod_retrieved_subject': 'Zustellnachweis verf√ºgbar',
            'email_pod_retrieved_title': 'POD erfolgreich abgerufen',
            'email_pod_retrieved_message': 'Der Zustellnachweis f√ºr Ihre Reklamation {claim_ref} ist jetzt verf√ºgbar.',
            'email_pod_failed_subject': 'POD nicht verf√ºgbar - Aktion erforderlich',
            'email_pod_failed_title': 'POD-Abruf fehlgeschlagen',
            'email_pod_failed_message': 'Wir konnten den Zustellnachweis f√ºr Ihre Reklamation {claim_ref} nicht abrufen.',
            'email_pod_reason': 'Grund',
            'email_pod_action_required': 'Bitte √ºberpr√ºfen Sie die Sendungsnummer beim Frachtf√ºhrer.',
            'email_greeting': 'Guten Tag',
            'email_signature_team': 'Das Refundly-Team',
            'email_view_claim': 'Reklamation ansehen',
            'email_manage_preferences': 'Sie k√∂nnen Ihre Benachrichtigungseinstellungen verwalten',
            'email_here': 'hier',
            
            # Claims Management Page
            'claims_management_title': 'Reklamationsverwaltung',
            'claims_management_caption': 'Reklamationen anzeigen und in Masse verwalten',
            'total_claims': 'Gesamt Reklamationen',
            'claims_accepted': 'Akzeptiert',
            'claims_pending': 'Ausstehend',
            'claims_rejected': 'Abgelehnt',
            'bulk_actions_title': 'Massenaktionen',
            'claims_list_title': 'Reklamationsliste',
            'btn_export_csv': 'Alle als CSV exportieren',
            'btn_send_reminders': 'Erinnerungen senden (in Bearbeitung)',
            'btn_delete_selection': 'Auswahl l√∂schen',
            'btn_confirm_delete': 'L√∂schung best√§tigen',
            'btn_cancel': 'Abbrechen',
            'delete_warning': 'Achtung: L√∂schung ist endg√ºltig!',
            'claims_deleted': 'Reklamationen gel√∂scht',
            'client_not_found': 'Kunde nicht gefunden',
            'error_loading_claims': 'Fehler beim Laden der Reklamationen',
            'csv_ready': 'Reklamationen exportbereit!',
            'error_export': 'Fehler beim Export',
            'no_tracking': 'Wiederholung nicht m√∂glich: Sendungsnummer fehlt',
            'rate_limit_reached': 'API-Limit f√ºr {carrier} erreicht. Erneut versuchen nach {time}',
            'retrieving_pod': 'POD wird abgerufen f√ºr {tracking}...',
            'pod_status_available': 'POD verf√ºgbar - {claim_ref}',
            'pod_status_failed': 'POD fehlgeschlagen - {claim_ref}',
            'pod_status_fetching': 'POD wird abgerufen - {claim_ref}',
            'pod_retrieved_success': 'POD erfolgreich abgerufen!',
            'pod_retrieved_notification_failed': 'POD abgerufen, aber Benachrichtigung fehlgeschlagen: {error}',
            'pod_failed_error': 'Fehlgeschlagen: {error}',
            'notification_failed': 'Benachrichtigung fehlgeschlagen: {error}',
            'notification_sent_persistent': 'E-Mail gesendet (dauerhafter Fehler)',
            'notification_temp_error': 'Vor√ºbergehender Fehler - keine E-Mail gesendet',
            'no_failed_pods': 'Keine fehlgeschlagenen PODs zum Wiederholen',
            'bulk_retry_processing': 'Bearbeitung {current}/{total}: {claim_ref}',
            'bulk_retry_summary': 'Massen-Wiederholung abgeschlossen!',
            'bulk_retry_success_count': 'Erfolg',
            'bulk_retry_failed_count': 'Fehlgeschlagen',
            'bulk_retry_skipped_count': '√úbersprungen (Rate Limit)',
            'download_csv': 'CSV herunterladen',
            'error_pod_retrieval': 'Fehler beim Abrufen des POD: {error}',
            'pod_not_available': 'POD nicht verf√ºgbar',
            'pod_file_not_found': 'POD-Datei nicht gefunden',
            'pod_gallery': 'POD-Galerie',
            'select_pod': 'POD ausw√§hlen',
            'no_pods_available': 'Keine PODs verf√ºgbar',
            'previous': 'Zur√ºck',
            'next': 'Weiter',
            'view_pod': 'POD ansehen',
            'btn_retry_pod': 'Wiederholen',
            'pod_analytics_title': 'POD-Analytik',
            'pod_analytics_subtitle': 'Leistung der Zustellnachweiserfassung',
            'time_range': 'Zeitraum',
            'last_7_days': 'Letzte 7 Tage',
            'last_30_days': 'Letzte 30 Tage',
            'last_90_days': 'Letzte 90 Tage',
            'all_time': 'Gesamte Zeit',
            'no_pod_data': 'Keine POD-Daten verf√ºgbar',
            'overview_metrics': '√úbersicht',
            'total_pods': 'Gesamt PODs',
            'avg_fetch_time': 'Durchschn. Zeit',
            'carrier_performance': 'Carrier-Leistung',
            'no_carrier_data': 'Keine Carrier-Daten',
            'retry_analysis': 'Wiederholungsanalyse',
            'no_retry_data': 'Keine Wiederholungsdaten',
            'retry_summary': 'Zusammenfassung',
            'error_breakdown': 'Fehlerklassifizierung',
            'no_errors': 'Keine Fehler aufgezeichnet',
            'occurrences': 'Vorkommen',
            'time_trends': 'Zeittrends',
            'no_trend_data': 'Keine Trenddaten',
            'avg_daily_pods': 'T√§glich durchschn.',
            'success': 'Erfolg',
            'avg': 'Durchschn.',
            
            # Settings Page
            'settings_header': 'Einstellungen',
            'store_management': 'Shop-Verwaltung',
            'store_management_caption': 'F√ºgen Sie Ihre E-Commerce-Shops hinzu, synchronisieren oder l√∂schen Sie sie',
            'connected_stores': 'Ihre verbundenen Shops',
            'sync': 'Synchronisieren',
            'delete': 'L√∂schen',
            'store_deleted': 'Shop gel√∂scht',
            'confirm_delete': 'Zum Best√§tigen erneut klicken',
            'no_stores': 'Noch keine Shops verbunden',
            'add_store': 'Neuen Shop hinzuf√ºgen',
            'connect_store': 'Neuen Shop verbinden',
            'platform': 'E-Commerce-Plattform',
            'store_name': 'Shop-Name',
            'url': 'URL',
            'shop_url': 'Shop-URL',
            'access_token': 'Zugriffstoken',
            'consumer_key': 'Consumer Key',
            'consumer_secret': 'Consumer Secret',
            'api_key': 'API-Schl√ºssel',
            'api_secret': 'API-Secret',
            'add_this_store': 'Diesen Shop hinzuf√ºgen',
            'all_fields_required': 'Alle Felder sind erforderlich',
            'store_added_success': 'Shop {store_name} erfolgreich hinzugef√ºgt!',
            'error_adding_store': 'Fehler beim Hinzuf√ºgen des Shops',
            'platform_info': 'Plattforminformationen',
            'platform_info_caption': 'Verbindungsdetails zu Ihrer E-Commerce-Plattform',
            'store_url_label': 'Shop-URL',
            'connection_status': 'Verbindungsstatus',
            'connected': 'Verbunden',
            'api_credentials': 'API-Anmeldedaten',
            'no_api_key': 'Kein API-Schl√ºssel registriert',
            'credentials_encrypted': 'Vollst√§ndige Anmeldedaten sind verschl√ºsselt und sicher gespeichert',
            'no_store_selected': 'Kein Shop ausgew√§hlt. Bitte verbinden Sie zuerst einen Shop.',
            'bank_info': 'Bankinformationen',
            'bank_info_caption': 'Ihre Daten zum Erhalt von Erstattungen (80% der wiedererlangten Betr√§ge)',
            'iban': 'IBAN',
            'bic': 'BIC/SWIFT',
            'account_holder': 'Kontoinhaber',
            'bank_name': 'Bankname',
            'bank_info_saved': 'Bankinformationen gespeichert',
            'edit_bank_info': 'Meine Bankdaten bearbeiten',
            'no_bank_info': 'Sie haben noch keine Bankdaten angegeben',
            'why_important': 'Warum ist das wichtig?',
            'bank_info_reason': 'Um Ihre Erstattungen automatisch zu erhalten, ben√∂tigen wir Ihre IBAN.',
            'add_bank_info': 'Meine Bankdaten hinzuf√ºgen',
            'save': 'Speichern',
            'iban_holder_required': 'IBAN und Kontoinhaber sind erforderlich',
            'bank_info_saved_success': 'Bankdaten erfolgreich gespeichert!',
            'notification_prefs': 'E-Mail-Benachrichtigungseinstellungen',
            'notification_prefs_caption': 'Kontrollieren Sie die E-Mails, die Sie erhalten, um nicht √ºberw√§ltigt zu werden',
            'notification_types': 'Benachrichtigungstypen',
            'notification_types_caption': 'Deaktivieren Sie Benachrichtigungen, die Sie nicht erhalten m√∂chten',
            'notif_claim_created': 'Neue Reklamation erstellt',
            'notif_claim_updated': 'Reklamation aktualisiert',
            'notif_claim_accepted': 'Reklamation akzeptiert',
            'notif_payment_received': 'Zahlung erhalten',
            'notif_deadline_warning': 'Frist naht (T-3)',
            'frequency': 'Sendeh√§ufigkeit',
            'frequency_caption': 'W√§hlen Sie, wie Sie Ihre Benachrichtigungen erhalten m√∂chten',
            'freq_immediate': 'Sofort (sobald das Ereignis eintritt)',
            'freq_daily': 'T√§glich (Zusammenfassung einmal t√§glich um 9 Uhr)',
            'freq_weekly': 'W√∂chentlich (Zusammenfassung am Montagmorgen)',
            'frequency_tip': 'Tipp: Wenn Sie viele Reklamationen erhalten, verhindert der \'T√§glich\'-Modus eine E-Mail-Flut.',
            'save_preferences': 'Meine Einstellungen speichern',
            'preferences_saved': 'Einstellungen erfolgreich gespeichert!',
            'email_templates': 'E-Mail-Vorlagen',
            'email_templates_caption': 'Passen Sie den Inhalt automatischer Eskalations-E-Mails an',
            'templates_info': 'Sie k√∂nnen E-Mails anpassen, die automatisch bei Eskalationen gesendet werden (Statusanfrage, Warnung, Mahnung).',
            'custom_templates': '{count} benutzerdefinierte Vorlage(n)',
            'default_templates': 'Standardvorlagen',
            'edit_templates': 'Vorlagen bearbeiten',
            
            # Reports Page
            'reports_header': 'Berichte & Analysen',
            'timeline_recent_events': 'Zeitleiste der letzten Ereignisse',
            'timeline_caption': 'Chronologische Historie Ihrer Reklamationen und Aktionen',
            'new_dispute': 'Neuer Streitfall erkannt',
            'claim_submitted': 'Reklamation eingereicht',
            'refund_received': 'Erstattung erhalten',
            'legal_escalation': 'Juristische Eskalation',
            'sync_successful': 'Synchronisierung erfolgreich',
            'orders_analyzed': '{count} Bestellungen analysiert',
            
            # Legal
            'legal_header_from': 'ABSENDER:',
            'legal_header_to': 'EMPF√ÑNGER:',
            'legal_header_subject': 'BETREFF: MAHNUNG WEGEN FEHLENDER ENTSCH√ÑDIGUNG',
            'legal_ref_claim': 'Reklamations-Nr:',
            'legal_ref_tracking': 'Sendungsnummer:',
            'legal_body_intro': 'Wir beziehen uns auf unsere Reklamation bez√ºglich des oben genannten Falls.',
            'legal_body_law': 'Gem√§√ü ¬ß 425 HGB haftet der Frachtf√ºhrer f√ºr den Schaden, der durch Verlust oder Besch√§digung des Gut in der Zeit von der √úbernahme zur Bef√∂rderung bis zur Ablieferung entsteht.',
            'legal_body_demand': 'Hiermit FORDERN WIR SIE AUF, den ausstehenden Betrag innerhalb von 8 Tagen auszugleichen.',
            'legal_body_closing': 'Sollte diese Frist fruchtlos verstreichen, werden wir rechtliche Schritte einleiten.',
            'legal_signature': 'IM AUFTRAG: DER AUTOMATISIERTE REKLAMATIONS-AGENT'
        },
        'IT': {
            # Dashboard
            'dashboard_title': 'Dashboard Commerciante',
            'recoverable': 'üí∞ RECUPERABILE',
            'your_share': 'üéØ TUA QUOTA',
            'recovered': '‚úÖ RECUPERATO',
            'disputes_count': 'üì¶ DISPUTE IDONEE',
            
            # Buttons & Actions
            'btn_back': 'Indietro',
            'btn_view': 'Visualizza',
            'btn_escalate': 'Escalare',
            'btn_archive': 'Archivia',
            'btn_download_pdf': 'Scarica PDF',
            'btn_add_note': 'Aggiungi nota',
            'btn_view_details': 'Vedi dettagli',
            'btn_save_note': 'Salva nota',
            
            # Page Titles
            'dispute_details': 'CONTROVERSIA',
            'carrier_overview': 'Panoramica',
            'order_information': 'Informazioni ordine',
            'timeline': 'Cronologia',
            'evidence_photos': 'Foto di prova',
            'statistics': 'Statistiche',
            'all_disputes': 'Tutte le controversie',
            
            # Labels
            'status': 'Stato',
            'financial': 'Finanziario',
            'actions': 'Azioni',
            'customer': 'Cliente',
            'email': 'Email',
            'address': 'Indirizzo',
            'order_date': 'Data ordine',
            'issue_type': 'Tipo di problema',
            'tracking': 'Tracciamento',
            'order': 'Ordine',
            
            # POD (Proof of Delivery) - UI
            'pod_status_title': 'Stato POD (Proof of Delivery)',
            'pod_status_caption': 'Visualizza disponibilit√† prove di consegna e riprova errori',
            'pod_available': 'POD disponibili',
            'pod_pending': 'In attesa',
            'pod_failed': 'Fallito',
            'pod_not_requested': 'Non richiesto',
            'pod_available_for': 'POD disponibile',
            'pod_failed_for': 'POD fallito',
            'pod_fetching': 'POD in recupero',
            'pod_url_unavailable': 'URL non disponibile',
            'pod_error': 'Errore',
            'btn_retry': 'Riprova',
            'btn_retry_all': 'Riprova tutti i falliti',
            'btn_download_pod': 'Scarica',
            'pod_bulk_retry_complete': 'Riprovazione di massa completata!',
            'pod_bulk_success': 'Successo',
            'pod_bulk_failed': 'Fallito',
            'pod_bulk_skipped': 'Saltato (rate limit)',
            'pod_bulk_processing': 'Elaborazione',
            
            # POD Email Notifications
            'email_pod_retrieved_subject': 'Prova di consegna disponibile',
            'email_pod_retrieved_title': 'POD recuperato con successo',
            'email_pod_retrieved_message': 'La prova di consegna per il tuo reclamo {claim_ref} √® ora disponibile.',
            'email_pod_failed_subject': 'POD non disponibile - Azione richiesta',
            'email_pod_failed_title': 'Recupero POD fallito',
            'email_pod_failed_message': 'Non siamo riusciti a recuperare la prova di consegna per il tuo reclamo {claim_ref}.',
            'email_pod_reason': 'Motivo',
            'email_pod_action_required': 'Si prega di verificare il numero di tracciamento con il corriere.',
            'email_greeting': 'Buongiorno',
            'email_signature_team': 'Il Team Refundly',
            'email_view_claim': 'Visualizza reclamo',
            'email_manage_preferences': 'Puoi gestire le tue preferenze di notifica',
            'email_here': 'qui',
            
            # Claims Management Page
            'claims_management_title': 'Gestione Reclami',
            'claims_management_caption': 'Visualizza e gestisci i tuoi reclami in massa',
            'total_claims': 'Reclami totali',
            'claims_accepted': 'Accettati',
            'claims_pending': 'In attesa',
            'claims_rejected': 'Rifiutati',
            'bulk_actions_title': 'Azioni di massa',
            'claims_list_title': 'Elenco reclami',
            'btn_export_csv': 'Esporta tutto in CSV',
            'btn_send_reminders': 'Invia promemoria (in corso)',
            'btn_delete_selection': 'Elimina selezione',
            'btn_confirm_delete': 'Conferma eliminazione',
            'btn_cancel': 'Annulla',
            'delete_warning': 'Attenzione: L\'eliminazione √® definitiva!',
            'claims_deleted': 'Reclami eliminati',
            'client_not_found': 'Cliente non trovato',
            'error_loading_claims': 'Errore durante il caricamento dei reclami',
            'csv_ready': 'reclami pronti per l\'esportazione!',
            'error_export': 'Errore durante l\'esportazione',
            'no_tracking': 'Impossibile riprovare: numero di tracciamento mancante',
            'rate_limit_reached': 'Limite API raggiunto per {carrier}. Riprova dopo {time}',
            'retrieving_pod': 'Recupero POD per {tracking}...',
            'pod_status_available': 'POD disponibile - {claim_ref}',
            'pod_status_failed': 'POD fallito - {claim_ref}',
            'pod_status_fetching': 'POD in fase di recupero - {claim_ref}',
            'pod_retrieved_success': 'POD recuperato con successo!',
            'pod_retrieved_notification_failed': 'POD recuperato ma notifica fallita: {error}',
            'pod_failed_error': 'Fallito: {error}',
            'notification_failed': 'Notifica fallita: {error}',
            'notification_sent_persistent': 'Email inviata (errore persistente)',
            'notification_temp_error': 'Errore temporaneo - nessuna email inviata',
            'no_failed_pods': 'Nessun POD fallito da riprovare',
            'bulk_retry_processing': 'Elaborazione {current}/{total}: {claim_ref}',
            'bulk_retry_summary': 'Riprova massiva completata!',
            'bulk_retry_success_count': 'Successo',
            'bulk_retry_failed_count': 'Fallito',
            'bulk_retry_skipped_count': 'Saltato (limite rate)',
            'download_csv': 'Scarica CSV',
            'error_pod_retrieval': 'Errore durante il recupero POD: {error}',
            'pod_not_available': 'POD non disponibile',
            'pod_file_not_found': 'File POD non trovato',
            'pod_gallery': 'Galleria POD',
            'select_pod': 'Seleziona un POD',
            'no_pods_available': 'Nessun POD disponibile',
            'previous': 'Precedente',
            'next': 'Successivo',
            'view_pod': 'Visualizza POD',
            'btn_retry_pod': 'Riprova',
            'pod_analytics_title': 'Analitiche POD',
            'pod_analytics_subtitle': 'Prestazioni recupero prove di consegna',
            'time_range': 'Periodo',
            'last_7_days': 'Ultimi 7 giorni',
            'last_30_days': 'Ultimi 30 giorni',
            'last_90_days': 'Ultimi 90 giorni',
            'all_time': 'Tutto il tempo',
            'no_pod_data': 'Nessun dato POD disponibile',
            'overview_metrics': 'Panoramica',
            'total_pods': 'Totale POD',
            'avg_fetch_time': 'Tempo medio',
            'carrier_performance': 'Prestazioni corriere',
            'no_carrier_data': 'Nessun dato corriere',
            'retry_analysis': 'Analisi ripetizioni',
            'no_retry_data': 'Nessun dato ripetizione',
            'retry_summary': 'Riepilogo',
            'error_breakdown': 'Classificazione errori',
            'no_errors': 'Nessun errore registrato',
            'occurrences': 'occorrenze',
            'time_trends': 'Tendenze temporali',
            'no_trend_data': 'Nessun dato tendenza',
            'avg_daily_pods': 'Media giornaliera',
            'success': 'Successo',
            'avg': 'Media',
            
            # Settings Page
            'settings_header': 'Impostazioni',
            'store_management': 'Gestione Negozi',
            'store_management_caption': 'Aggiungi, sincronizza o elimina i tuoi negozi e-commerce',
            'connected_stores': 'I tuoi negozi connessi',
            'sync': 'Sincronizza',
            'delete': 'Elimina',
            'store_deleted': 'Negozio eliminato',
            'confirm_delete': 'Clicca di nuovo per confermare',
            'no_stores': 'Nessun negozio connesso per ora',
            'add_store': 'Aggiungi un nuovo negozio',
            'connect_store': 'Connetti un nuovo negozio',
            'platform': 'Piattaforma e-commerce',
            'store_name': 'Nome del negozio',
            'url': 'URL',
            'shop_url': 'URL del negozio',
            'access_token': 'Access Token',
            'consumer_key': 'Consumer Key',
            'consumer_secret': 'Consumer Secret',
            'api_key': 'Chiave API',
            'api_secret': 'Secret API',
            'add_this_store': 'Aggiungi questo negozio',
            'all_fields_required': 'Tutti i campi sono obbligatori',
            'store_added_success': 'Negozio {store_name} aggiunto con successo!',
            'error_adding_store': 'Errore durante l\'aggiunta del negozio',
            'platform_info': 'Informazioni Piattaforma',
            'platform_info_caption': 'Dettagli di connessione alla tua piattaforma e-commerce',
            'store_url_label': 'URL del negozio',
            'connection_status': 'Stato connessione',
            'connected': 'Connesso',
            'api_credentials': 'Credenziali API',
            'no_api_key': 'Nessuna chiave API registrata',
            'credentials_encrypted': 'Le credenziali complete sono crittografate e archiviate in modo sicuro',
            'no_store_selected': 'Nessun negozio selezionato. Si prega di connettere prima un negozio.',
            'bank_info': 'Informazioni Bancarie',
            'bank_info_caption': 'I tuoi dati per ricevere i rimborsi (80% degli importi recuperati)',
            'iban': 'IBAN',
            'bic': 'BIC/SWIFT',
            'account_holder': 'Intestatario del conto',
            'bank_name': 'Nome della banca',
            'bank_info_saved': 'Informazioni bancarie salvate',
            'edit_bank_info': 'Modifica i miei dati bancari',
            'no_bank_info': 'Non hai ancora fornito i tuoi dati bancari',
            'why_important': 'Perch√© √® importante?',
            'bank_info_reason': 'Per ricevere i tuoi rimborsi automaticamente, abbiamo bisogno del tuo IBAN.',
            'add_bank_info': 'Aggiungi i miei dati bancari',
            'save': 'Salva',
            'iban_holder_required': 'IBAN e intestatario del conto sono obbligatori',
            'bank_info_saved_success': 'Dati bancari salvati con successo!',
            'notification_prefs': 'Preferenze Notifiche Email',
            'notification_prefs_caption': 'Controlla le email che ricevi per non essere sopraffatto',
            'notification_types': 'Tipi di notifiche',
            'notification_types_caption': 'Deseleziona le notifiche che non vuoi ricevere',
            'notif_claim_created': 'Nuovo reclamo creato',
            'notif_claim_updated': 'Reclamo aggiornato',
            'notif_claim_accepted': 'Reclamo accettato',
            'notif_payment_received': 'Pagamento ricevuto',
            'notif_deadline_warning': 'Scadenza imminente (G-3)',
            'frequency': 'Frequenza di invio',
            'frequency_caption': 'Scegli come ricevere le tue notifiche',
            'freq_immediate': 'Immediato (non appena si verifica l\'evento)',
            'freq_daily': 'Giornaliero (riepilogo una volta al giorno alle 9:00)',
            'freq_weekly': 'Settimanale (riepilogo il luned√¨ mattina)',
            'frequency_tip': 'Suggerimento: se ricevi molti reclami, la modalit√† \'Giornaliero\' eviter√† il sovraccarico di email.',
            'save_preferences': 'Salva le mie preferenze',
            'preferences_saved': 'Preferenze salvate con successo!',
            'email_templates': 'Modelli Email',
            'email_templates_caption': 'Personalizza il contenuto delle email di escalation automatica',
            'templates_info': 'Puoi personalizzare le email inviate automaticamente durante le escalation (richiesta di stato, avviso, messa in mora).',
            'custom_templates': '{count} modello(i) personalizzato(i)',
            'default_templates': 'Modelli predefiniti',
            'edit_templates': 'Modifica modelli',
            
            # Reports Page
            'reports_header': 'Report & Analisi',
            'timeline_recent_events': 'Timeline Eventi Recenti',
            'timeline_caption': 'Cronologia cronologica dei tuoi reclami e azioni',
            'new_dispute': 'Nuova controversia rilevata',
            'claim_submitted': 'Reclamo inviato',
            'refund_received': 'Rimborso ricevuto',
            'legal_escalation': 'Escalation legale',
            'sync_successful': 'Sincronizzazione riuscita',
            'orders_analyzed': '{count} ordini analizzati',
            
            # Legal
            'legal_header_from': 'MITTENTE:',
            'legal_header_to': 'DESTINATARIO:',
            'legal_header_subject': 'OGGETTO: MESSA IN MORA PER MANCATO INDENNIZZO',
            'legal_ref_claim': 'Rif. Reclamo:',
            'legal_ref_tracking': 'Rif. Spedizione:',
            'legal_body_intro': 'Facciamo seguito al nostro reclamo relativo alla controversia citata in riferimento.',
            'legal_body_law': 'Ai sensi dell\'articolo 1693 del Codice Civile, il vettore √® responsabile della perdita e dell\'avaria delle cose consegnategli per il trasporto.',
            'legal_body_demand': 'Con la presente, vi METTIAMO IN MORA affinch√© provvediate al pagamento entro 8 giorni.',
            'legal_body_closing': 'In mancanza di ci√≤, agiremo nelle sedi competenti.',
            'legal_signature': 'PER ORDINE: L\'AGENTE DI RECLAMO AUTOMATIZZATO'
        },
        'ES': {
            # Dashboard
            'dashboard_title': 'Panel de Control',
            'recoverable': 'üí∞ RECUPERABLE',
            'your_share': 'üéØ TU PARTE',
            'recovered': '‚úÖ RECUPERADO',
            'disputes_count': 'üì¶ DISPUTAS ELEGIBLES',
            
            # Buttons & Actions
            'btn_back': 'Atr√°s',
            'btn_view': 'Ver',
            'btn_escalate': 'Escalar',
            'btn_archive': 'Archivar',
            'btn_download_pdf': 'Descargar PDF',
            'btn_add_note': 'A√±adir nota',
            'btn_view_details': 'Ver detalles',
            'btn_save_note': 'Guardar nota',
            
            # Page Titles
            'dispute_details': 'DISPUTA',
            'carrier_overview': 'Resumen',
            'order_information': 'Informaci√≥n del pedido',
            'timeline': 'L√≠nea de tiempo',
            'evidence_photos': 'Fotos de prueba',
            'statistics': 'Estad√≠sticas',
            'all_disputes': 'Todas las disputas',
            
            # Labels
            'status': 'Estado',
            'financial': 'Financiero',
            'actions': 'Acciones',
            'customer': 'Cliente',
            'email': 'Correo',
            'address': 'Direcci√≥n',
            'order_date': 'Fecha del pedido',
            'issue_type': 'Tipo de problema',
            'tracking': 'Seguimiento',
            'order': 'Pedido',
            
            # POD (Proof of Delivery) - UI
            'pod_status_title': 'Estado POD (Proof of Delivery)',
            'pod_status_caption': 'Ver disponibilidad de pruebas de entrega y reintentar fallos',
            'pod_available': 'PODs disponibles',
            'pod_pending': 'Pendiente',
            'pod_failed': 'Fallido',
            'pod_not_requested': 'No solicitado',
            'pod_available_for': 'POD disponible',
            'pod_failed_for': 'POD fallido',
            'pod_fetching': 'POD siendo recuperado',
            'pod_url_unavailable': 'URL no disponible',
            'pod_error': 'Error',
            'btn_retry': 'Reintentar',
            'btn_retry_all': 'Reintentar todos los fallidos',
            'btn_download_pod': 'Descargar',
            'pod_bulk_retry_complete': '¬°Reintento masivo completado!',
            'pod_bulk_success': '√âxito',
            'pod_bulk_failed': 'Fallido',
            'pod_bulk_skipped': 'Omitido (rate limit)',
            'pod_bulk_processing': 'Procesando',
            
            # POD Email Notifications
            'email_pod_retrieved_subject': 'Prueba de entrega disponible',
            'email_pod_retrieved_title': 'POD recuperado con √©xito',
            'email_pod_retrieved_message': 'La prueba de entrega para tu reclamaci√≥n {claim_ref} ya est√° disponible.',
            'email_pod_failed_subject': 'POD no disponible - Acci√≥n requerida',
            'email_pod_failed_title': 'Recuperaci√≥n de POD fallida',
            'email_pod_failed_message': 'No pudimos recuperar la prueba de entrega para tu reclamaci√≥n {claim_ref}.',
            'email_pod_reason': 'Raz√≥n',
            'email_pod_action_required': 'Por favor verifica el n√∫mero de seguimiento con el transportista.',
            'email_greeting': 'Hola',
            'email_signature_team': 'El Equipo Refundly',
            'email_view_claim': 'Ver reclamaci√≥n',
            'email_manage_preferences': 'Puedes gestionar tus preferencias de notificaci√≥n',
            'email_here': 'aqu√≠',
            
            # Claims Management Page
            'claims_management_title': 'Gesti√≥n de Reclamaciones',
            'claims_management_caption': 'Visualiza y gestiona tus reclamaciones de forma masiva',
            'total_claims': 'Reclamaciones totales',
            'claims_accepted': 'Aceptadas',
            'claims_pending': 'Pendientes',
            'claims_rejected': 'Rechazadas',
            'bulk_actions_title': 'Acciones masivas',
            'claims_list_title': 'Lista de reclamaciones',
            'btn_export_csv': 'Exportar todo a CSV',
            'btn_send_reminders': 'Enviar recordatorios (en progreso)',
            'btn_delete_selection': 'Eliminar selecci√≥n',
            'btn_confirm_delete': 'Confirmar eliminaci√≥n',
            'btn_cancel': 'Cancelar',
            'delete_warning': 'Advertencia: ¬°La eliminaci√≥n es permanente!',
            'claims_deleted': 'Reclamaciones eliminadas',
            'client_not_found': 'Cliente no encontrado',
            'error_loading_claims': 'Error al cargar reclamaciones',
            'csv_ready': 'reclamaciones listas para exportar!',
            'error_export': 'Error durante la exportaci√≥n',
            'no_tracking': 'No se puede reintentar: n√∫mero de seguimiento faltante',
            'rate_limit_reached': 'L√≠mite de API alcanzado para {carrier}. Reintentar despu√©s de {time}',
            'retrieving_pod': 'Recuperando POD para {tracking}...',
            'pod_status_available': 'POD disponible - {claim_ref}',
            'pod_status_failed': 'POD fallido - {claim_ref}',
            'pod_status_fetching': 'POD en recuperaci√≥n - {claim_ref}',
            'pod_retrieved_success': '¬°POD recuperado con √©xito!',
            'pod_retrieved_notification_failed': 'POD recuperado pero notificaci√≥n fallida: {error}',
            'pod_failed_error': 'Fallido: {error}',
            'notification_failed': 'Notificaci√≥n fallida: {error}',
            'notification_sent_persistent': 'Email enviado (error persistente)',
            'notification_temp_error': 'Error temporal - no se envi√≥ email',
            'no_failed_pods': 'No hay PODs fallidos para reintentar',
            'bulk_retry_processing': 'Procesando {current}/{total}: {claim_ref}',
            'bulk_retry_summary': '¬°Reintento masivo completado!',
            'bulk_retry_success_count': '√âxito',
            'bulk_retry_failed_count': 'Fallido',
            'bulk_retry_skipped_count': 'Omitido (l√≠mite de tasa)',
            'download_csv': 'Descargar CSV',
            'error_pod_retrieval': 'Error al recuperar POD: {error}',
            'pod_not_available': 'POD no disponible',
            'pod_file_not_found': 'Archivo POD no encontrado',
            'pod_gallery': 'Galer√≠a POD',
            'select_pod': 'Seleccionar un POD',
            'no_pods_available': 'No hay PODs disponibles',
            'previous': 'Anterior',
            'next': 'Siguiente',
            'view_pod': 'Ver POD',
            'btn_retry_pod': 'Reintentar',
            'pod_analytics_title': 'Anal√≠ticas POD',
            'pod_analytics_subtitle': 'Rendimiento de recuperaci√≥n de pruebas de entrega',
            'time_range': 'Per√≠odo',
            'last_7_days': '√öltimos 7 d√≠as',
            'last_30_days': '√öltimos 30 d√≠as',
            'last_90_days': '√öltimos 90 d√≠as',
            'all_time': 'Todo el tiempo',
            'no_pod_data': 'No hay datos POD disponibles',
            'overview_metrics': 'Visi√≥n general',
            'total_pods': 'Total PODs',
            'avg_fetch_time': 'Tiempo promedio',
            'carrier_performance': 'Rendimiento por transportista',
            'no_carrier_data': 'No hay datos de transportista',
            'retry_analysis': 'An√°lisis de reintentos',
            'no_retry_data': 'No hay datos de reintento',
            'retry_summary': 'Resumen',
            'error_breakdown': 'Clasificaci√≥n de errores',
            'no_errors': 'No se registraron errores',
            'occurrences': 'ocurrencias',
            'time_trends': 'Tendencias temporales',
            'no_trend_data': 'No hay datos de tendencia',
            'avg_daily_pods': 'Promedio diario',
            'success': '√âxito',
            'avg': 'Prom',
            
            # Settings Page
            'settings_header': 'Configuraci√≥n',
            'store_management': 'Gesti√≥n de Tiendas',
            'store_management_caption': 'A√±ade, sincroniza o elimina tus tiendas de e-commerce',
            'connected_stores': 'Tus tiendas conectadas',
            'sync': 'Sincronizar',
            'delete': 'Eliminar',
            'store_deleted': 'Tienda eliminada',
            'confirm_delete': 'Haz clic de nuevo para confirmar',
            'no_stores': 'A√∫n no hay tiendas conectadas',
            'add_store': 'A√±adir una nueva tienda',
            'connect_store': 'Conectar una nueva tienda',
            'platform': 'Plataforma de e-commerce',
            'store_name': 'Nombre de la tienda',
            'url': 'URL',
            'shop_url': 'URL de la tienda',
            'access_token': 'Access Token',
            'consumer_key': 'Consumer Key',
            'consumer_secret': 'Consumer Secret',
            'api_key': 'Clave API',
            'api_secret': 'Secreto API',
            'add_this_store': 'A√±adir esta tienda',
            'all_fields_required': 'Todos los campos son obligatorios',
            'store_added_success': '¬°Tienda {store_name} a√±adida con √©xito!',
            'error_adding_store': 'Error al a√±adir la tienda',
            'platform_info': 'Informaci√≥n de Plataforma',
            'platform_info_caption': 'Detalles de conexi√≥n a tu plataforma de e-commerce',
            'store_url_label': 'URL de la tienda',
            'connection_status': 'Estado de conexi√≥n',
            'connected': 'Conectado',
            'api_credentials': 'Credenciales API',
            'no_api_key': 'No hay clave API registrada',
            'credentials_encrypted': 'Las credenciales completas est√°n cifradas y almacenadas de forma segura',
            'no_store_selected': 'No hay tienda seleccionada. Por favor, conecta primero una tienda.',
            'bank_info': 'Informaci√≥n Bancaria',
            'bank_info_caption': 'Tus datos para recibir reembolsos (80% de los montos recuperados)',
            'iban': 'IBAN',
            'bic': 'BIC/SWIFT',
            'account_holder': 'Titular de la cuenta',
            'bank_name': 'Nombre del banco',
            'bank_info_saved': 'Informaci√≥n bancaria guardada',
            'edit_bank_info': 'Editar mis datos bancarios',
            'no_bank_info': 'A√∫n no has proporcionado tus datos bancarios',
            'why_important': '¬øPor qu√© es importante?',
            'bank_info_reason': 'Para recibir tus reembolsos autom√°ticamente, necesitamos tu IBAN.',
            'add_bank_info': 'A√±adir mis datos bancarios',
            'save': 'Guardar',
            'iban_holder_required': 'El IBAN y el titular de la cuenta son obligatorios',
            'bank_info_saved_success': '¬°Datos bancarios guardados con √©xito!',
            'notification_prefs': 'Preferencias de Notificaciones por Email',
            'notification_prefs_caption': 'Controla los emails que recibes para no estar abrumado',
            'notification_types': 'Tipos de notificaciones',
            'notification_types_caption': 'Desmarca las notificaciones que no quieras recibir',
            'notif_claim_created': 'Nueva reclamaci√≥n creada',
            'notif_claim_updated': 'Reclamaci√≥n actualizada',
            'notif_claim_accepted': 'Reclamaci√≥n aceptada',
            'notif_payment_received': 'Pago recibido',
            'notif_deadline_warning': 'Plazo pr√≥ximo (D-3)',
            'frequency': 'Frecuencia de env√≠o',
            'frequency_caption': 'Elige c√≥mo recibir tus notificaciones',
            'freq_immediate': 'Inmediato (tan pronto como ocurra el evento)',
            'freq_daily': 'Diario (resumen una vez al d√≠a a las 9:00)',
            'freq_weekly': 'Semanal (resumen el lunes por la ma√±ana)',
            'frequency_tip': 'Consejo: si recibes muchas reclamaciones, el modo \'Diario\' evitar√° la sobrecarga de emails.',
            'save_preferences': 'Guardar mis preferencias',
            'preferences_saved': '¬°Preferencias guardadas con √©xito!',
            'email_templates': 'Plantillas de Email',
            'email_templates_caption': 'Personaliza el contenido de los emails de escalaci√≥n autom√°tica',
            'templates_info': 'Puedes personalizar los emails enviados autom√°ticamente durante las escalaciones (solicitud de estado, advertencia, requerimiento formal).',
            'custom_templates': '{count} plantilla(s) personalizada(s)',
            'default_templates': 'Plantillas predeterminadas',
            'edit_templates': 'Editar plantillas',
            
            # Reports Page
            'reports_header': 'Informes y An√°lisis',
            'timeline_recent_events': 'L√≠nea de Tiempo de Eventos Recientes',
            'timeline_caption': 'Historial cronol√≥gico de tus reclamaciones y acciones',
            'new_dispute': 'Nueva disputa detectada',
            'claim_submitted': 'Reclamaci√≥n enviada',
            'refund_received': 'Reembolso recibido',
            'legal_escalation': 'Escalaci√≥n legal',
            'sync_successful': 'Sincronizaci√≥n exitosa',
            'orders_analyzed': '{count} pedidos analizados',
            
            # Legal
            'legal_header_from': 'REMITENTE:',
            'legal_header_to': 'DESTINATARIO:',
            'legal_header_subject': 'ASUNTO: REQUERIMIENTO FORMAL POR FALTA DE INDEMNIZACI√ìN',
            'legal_ref_claim': 'Ref. Reclamaci√≥n:',
            'legal_ref_tracking': 'Ref. Seguimiento:',
            'legal_body_intro': 'Hacemos seguimiento a nuestra reclamaci√≥n relativa a la disputa mencionada.',
            'legal_body_law': 'De acuerdo con la Ley 15/2009 del Contrato de Transporte Terrestre, el porteador responder√° de la p√©rdida total o parcial de las mercanc√≠as.',
            'legal_body_demand': 'Por la presente, le REQUERIMOS FORMALMENTE para que proceda al pago en un plazo de 8 d√≠as.',
            'legal_body_closing': 'De lo contrario, tomaremos las medidas legales oportunas.',
            'legal_signature': 'POR ORDEN: EL AGENTE DE RECLAMACIONES AUTOMATIZADO'
        }
    }
    
    # Auto-detect language if not provided
    if lang is None:
        lang = get_browser_language()
        
    target_lang = lang.upper()
    
    # 1. Try target language
    val = translations.get(target_lang, {}).get(key)
    if val:
        return val
        
    # 2. Fallback to English (Global)
    val_en = translations.get('EN', {}).get(key)
    if val_en:
        return val_en
        
    # 3. Fallback to French (Default)
    val_fr = translations.get('FR', {}).get(key)
    if val_fr:
        return val_fr
        
    # 4. Return key as last resort
    return key

